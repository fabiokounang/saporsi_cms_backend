<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Navbar • Saporsi CMS</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#f6f4f1;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --line:#ece7e1;
      --accent:#ff6a2a;
      --accent2:#ff3d3d;
      --shadow: 0 18px 60px rgba(16,24,40,.10);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Montserrat,system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(255,106,42,.12), transparent 60%),
        radial-gradient(900px 500px at 85% 90%, rgba(255,61,61,.10), transparent 60%),
        linear-gradient(180deg, #fbfaf8, var(--bg));
      min-height:100vh;
    }

    .shell{display:grid;grid-template-columns:260px 1fr;min-height:100vh}
    @media (max-width: 980px){.shell{grid-template-columns:1fr}aside{display:none}}

    /* Sidebar */
    aside{
      padding:18px;
      border-right:1px solid rgba(236,231,225,.9);
      background: rgba(255,255,255,.55);
      backdrop-filter: blur(8px);
    }
    .brand{
      display:flex;align-items:center;gap:12px;
      padding:12px;border-radius:16px;
      background: rgba(255,255,255,.75);
      border:1px solid rgba(255,255,255,.8);
      box-shadow: 0 10px 30px rgba(16,24,40,.06);
    }
    .logo{
      width:42px;height:42px;border-radius:14px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 12px 26px rgba(255,106,42,.25);
    }
    .brand h1{margin:0;font-size:14px;letter-spacing:.3px}
    .brand p{margin:2px 0 0 0;font-size:12px;color:var(--muted)}

    nav{margin-top:16px}
    .navItem{
      display:flex;align-items:center;gap:10px;
      padding:11px 12px;border-radius:14px;
      color:#374151;text-decoration:none;
      font-size:13px;font-weight:600;
      border:1px solid transparent;
      transition:.15s ease;
    }
    .navItem:hover{background:rgba(255,255,255,.8);border-color:rgba(236,231,225,.9)}
    .navItem.active{background:rgba(255,106,42,.12);border-color:rgba(255,106,42,.25);color:#111827}
    .dot{width:8px;height:8px;border-radius:999px;background:rgba(17,24,39,.35)}
    .navItem.active .dot{background:linear-gradient(135deg,var(--accent),var(--accent2))}

    /* Main */
    main{padding:18px 18px 28px}
    .topbar{
      display:flex;align-items:center;justify-content:space-between;gap:14px;
      padding:14px 16px;border-radius:var(--radius);
      background:rgba(255,255,255,.8);
      border:1px solid rgba(236,231,225,.9);
      box-shadow: 0 12px 34px rgba(16,24,40,.06);
    }
    .topbar h2{margin:0;font-size:16px}
    .topbar .sub{color:var(--muted);font-size:12px;margin-top:2px}
    .userBox{
      display:flex;align-items:center;gap:10px;
      padding:8px 10px;border-radius:999px;
      background:rgba(255,255,255,.9);
      border:1px solid rgba(236,231,225,.9);
    }
    .avatar{
      width:34px;height:34px;border-radius:999px;
      background:rgba(17,24,39,.08);
      display:grid;place-items:center;
      font-weight:800;color:#374151;
    }
    .userMeta{line-height:1.2}
    .userMeta .name{font-size:12px;font-weight:700}
    .userMeta .role{font-size:11px;color:var(--muted)}
    .logout{
      margin-left:10px;
      padding:10px 14px;border-radius:999px;
      text-decoration:none;font-weight:700;font-size:12px;color:#fff;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      box-shadow:0 14px 26px rgba(255,106,42,.20);
    }

    .content{margin-top:16px;display:grid;grid-template-columns: 1fr;gap:14px}
    .card{
      background:rgba(255,255,255,.9);
      border:1px solid rgba(236,231,225,.9);
      border-radius:var(--radius);
      box-shadow:0 12px 30px rgba(16,24,40,.06);
      padding:16px;
    }
    .cardHead{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin-bottom:10px}
    .cardHead h3{margin:0;font-size:14px}
    .cardHead p{margin:6px 0 0 0;color:var(--muted);font-size:12px;line-height:1.6;max-width:70ch}

    .alertOk{
      background:#ecfdf3;border:1px solid #bbf7d0;color:#065f46;
      padding:10px 12px;border-radius:14px;font-size:12px;margin-bottom:12px
    }
    .alertErr{
      background:#fff1f2;border:1px solid #fecdd3;color:#9f1239;
      padding:10px 12px;border-radius:14px;font-size:12px;margin-bottom:12px
    }

    .grid2{display:grid;grid-template-columns: 1fr 1fr;gap:12px}
    @media (max-width: 980px){.grid2{grid-template-columns:1fr}}

    label{display:block;font-size:12px;color:#374151;margin:0 0 7px 2px}
    input, select{
      width:100%;
      padding:12px 12px;
      border:1px solid var(--line);
      border-radius:14px;
      outline:none;
      font-family:inherit;
      font-size:13px;
      background:#fff;
      transition:.15s ease;
    }
    input:focus, select:focus{
      border-color: rgba(255,106,42,.55);
      box-shadow: 0 0 0 5px rgba(255,106,42,.12);
    }

    .actions{
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:flex-end;
      margin-top:12px
    }

    .btn{
      border:1px solid rgba(236,231,225,.9);
      background: rgba(255,255,255,.95);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      font-weight:800;
      font-family:inherit;
      font-size:12px;
      transition:.15s ease;
      text-decoration:none;
      color:#111827;
    }
    .btn:hover{
      border-color: rgba(255,106,42,.35);
      box-shadow: 0 10px 24px rgba(16,24,40,.06);
      transform: translateY(-1px);
    }
    .btnPrimary{
      border:0;
      color:#fff;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 14px 26px rgba(255,106,42,.20);
    }
    .btnDanger{
      border:1px solid rgba(254,205,211,.9);
      background:#fff1f2;
      color:#9f1239;
      font-weight:800;
    }

    /* Table */
    .tableWrap{
      overflow:auto;
      border:1px solid rgba(236,231,225,.9);
      border-radius:16px;
      background: rgba(255,255,255,.95);
    }
    table{width:100%;border-collapse:separate;border-spacing:0;min-width:860px}
    thead th{
      text-align:left;
      font-size:12px;
      color:#374151;
      padding:12px 12px;
      background: rgba(246,244,241,.85);
      border-bottom:1px solid rgba(236,231,225,.9);
      position:sticky;top:0;
    }
    tbody td{
      padding:10px 12px;
      border-bottom:1px solid rgba(236,231,225,.7);
      vertical-align:middle;
      font-size:13px;
    }
    tbody tr:hover td{background: rgba(255,106,42,.06)}
    .mini{width:90px}
    .chk{width:18px;height:18px}
    .rowActions{display:flex;gap:8px;align-items:center}
    .hint{color:var(--muted);font-size:12px;margin-top:8px;line-height:1.6}
  </style>
</head>

<body>
  <div class="shell">

    <!-- Sidebar -->
    <aside>
      <div class="brand">
        <div class="logo"></div>
        <div>
          <h1>SAPORSI CMS</h1>
          <p>Company Profile Manager</p>
        </div>
      </div>
    </aside>

    <!-- Main -->
    <main>
      <header class="topbar">
        <div>
          <h2>Navbar</h2>
          <div class="sub">Atur menu navigasi, label ID/EN, urutan, dan CTA.</div>
        </div>

        <div style="display:flex;align-items:center;">
          <a class="logout" href="/admin">Back to Dashboard</a> &nbsp;&nbsp;
          <div class="userBox">
            <div class="avatar"><%= (user.name)[0].toUpperCase() %></div>
            <div class="userMeta">
              <div class="name"><%= user.name %></div>
              <div class="role">(<%= user.role %>)</div>
            </div>
          </div>
          <a class="logout" href="/auth/logout">Logout</a>
        </div>
      </header>

      <section class="content">

        <% if (saved) { %>
          <div class="alertOk">Tersimpan ✅</div>
        <% } %>

        <% if (error) { %>
          <div class="alertErr"><%= error %></div>
        <% } %>

        <!-- Settings -->
        <div class="card">
          <div class="cardHead">
            <div>
              <h3>Navbar Settings</h3>
              <p>Pengaturan global navbar: logo, tombol CTA, link CTA, dan toggle bahasa.</p>
            </div>
          </div>

          <form method="post" action="/admin/navbar" enctype="multipart/form-data">
            <div class="grid2">
              <div>
                <label>Logo</label>

                <% if (settings?.logo_path) { %>
                  <div style="margin-bottom:10px;">
                    <!-- <img src="<%= settings.logo_path %>" alt="Logo" style="height:48px;border-radius:10px;border:1px solid #eee;padding:6px;background:#fff"> -->
                  </div>
                <% } %>

                <input type="hidden" name="current_logo" value="<%= settings?.logo_path || '' %>" />

                <input type="file" name="logo" accept="image/*" />
              </div>


              <div>
                <label>Language Toggle</label>
                <select name="show_language_toggle">
                  <option value="1" <%= settings?.show_language_toggle ? 'selected' : '' %>>Show</option>
                  <option value="0" <%= !settings?.show_language_toggle ? 'selected' : '' %>>Hide</option>
                </select>
              </div>

              <div>
                <label>CTA Label (ID)</label>
                <input name="cta_label_id" value="<%= settings?.cta_label_id || 'Pesan Mesin' %>" placeholder="Pesan Mesin" />
              </div>

              <div>
                <label>CTA Label (EN)</label>
                <input name="cta_label_en" value="<%= settings?.cta_label_en || 'Order Machine' %>" placeholder="Order Machine" />
              </div>

              <div style="grid-column: span 2;">
                <label>CTA URL</label>
                <input name="cta_url" value="<%= settings?.cta_url || '#' %>" placeholder="https://wa.me/... atau /#contact" />
              </div>
            </div>

            <div class="actions">
              <button class="btn btnPrimary" type="submit">Simpan Perubahan</button>
            </div>

            <div class="hint">
              Tips: untuk anchor, pakai format <strong>/#about</strong> atau <strong>/#gallery</strong>.
            </div>
          </form>
        </div>

        <!-- Items -->
        <div class="card">
          <div class="cardHead">
            <div>
              <h3>Navbar Items</h3>
              <p>Atur menu yang tampil di navbar. Centang “Active” untuk menampilkan item tersebut.</p>
            </div>

            <form method="post" action="/admin/navbar/add">
              <button class="btn" type="submit">+ Add Menu Item</button>
            </form>
          </div>

          <!-- FORM items: tetap submit ke /admin/navbar -->
          <form method="post" action="/admin/navbar">
            <div class="tableWrap">
              <table>
                <thead>
                  <tr>
                    <th style="width:90px;">Active</th>
                    <th>Label ID</th>
                    <th>Label EN</th>
                    <th>URL</th>
                    <th style="width:120px;">Order</th>
                    <th style="width:140px;">Action</th>
                  </tr>
                </thead>

                <tbody>
                  <% (items || []).forEach((it) => { %>
                    <tr>
                      <td>
                        <input class="chk" type="checkbox" name="is_active" value="<%= it.id %>" <%= it.is_active ? 'checked' : '' %> />
                      </td>

                      <td>
                        <input type="hidden" name="item_id" value="<%= it.id %>" />
                        <input name="label_id" value="<%= it.label_id %>" placeholder="Beranda" />
                      </td>

                      <td>
                        <input name="label_en" value="<%= it.label_en %>" placeholder="Home" />
                      </td>

                      <td>
                        <input name="url" value="<%= it.url %>" placeholder="/#about" />
                      </td>

                      <td>
                        <input class="mini" name="sort_order" value="<%= it.sort_order %>" />
                      </td>

                      <td>
                        <div class="rowActions">
                          <form method="post" action="/admin/navbar/<%= it.id %>/delete" onsubmit="return confirm('Hapus item ini?')">
                            <button class="btn btnDanger" type="submit">Delete</button>
                          </form>
                        </div>
                      </td>
                    </tr>
                  <% }) %>
                </tbody>
              </table>
            </div>

            <div class="actions">
              <button class="btn btnPrimary" type="submit">Simpan Menu Items</button>
            </div>

            <div class="hint">
              Catatan: Jika kamu mengubah banyak item sekaligus, klik <strong>Simpan Menu Items</strong> setelah selesai.
            </div>
          </form>
        </div>

      </section>
    </main>
  </div>
</body>
</html>
